/*
 * traffic_light.c
 *
 *  Created on: Sep 28, 2023
 *      Author: Windows
 */

#include "traffic_ligh.h"

int red_counter = 5;
int green_counter = 3;
int yellow_counter = 2;

int counter = 5;
int light_mode = 0;
void traffic_light(){
	switch (light_mode){
	case 0:
			HAL_GPIO_WritePin(PA1_GPIO_Port, PA1_Pin, RESET);
			HAL_GPIO_WritePin(PA2_GPIO_Port, PA2_Pin, SET);
			HAL_GPIO_WritePin(PA3_GPIO_Port, PA3_Pin, SET);

			HAL_GPIO_WritePin(PA4_GPIO_Port, PA4_Pin, SET);
			HAL_GPIO_WritePin(PA5_GPIO_Port, PA5_Pin, SET);
			HAL_GPIO_WritePin(PA6_GPIO_Port, PA6_Pin, RESET);
			if(counter <= yellow_counter ){
				light_mode = 1;
			}
			break;
		case 1:
			HAL_GPIO_WritePin(PA1_GPIO_Port, PA1_Pin, RESET);
			HAL_GPIO_WritePin(PA2_GPIO_Port, PA2_Pin, SET);
			HAL_GPIO_WritePin(PA3_GPIO_Port, PA3_Pin, SET);

			HAL_GPIO_WritePin(PA4_GPIO_Port, PA4_Pin, SET);
			HAL_GPIO_WritePin(PA5_GPIO_Port, PA5_Pin, RESET);
			HAL_GPIO_WritePin(PA6_GPIO_Port, PA6_Pin, SET);
			if(counter <= 0){
				light_mode = 2;
				counter = green_counter;
			}
			break;
		case 2:
			HAL_GPIO_WritePin(PA1_GPIO_Port, PA1_Pin, SET);
			HAL_GPIO_WritePin(PA2_GPIO_Port, PA2_Pin, SET);
			HAL_GPIO_WritePin(PA3_GPIO_Port, PA3_Pin, RESET);

			HAL_GPIO_WritePin(PA4_GPIO_Port, PA4_Pin, RESET);
			HAL_GPIO_WritePin(PA5_GPIO_Port, PA5_Pin, SET);
			HAL_GPIO_WritePin(PA6_GPIO_Port, PA6_Pin, SET);
			if(counter <= 0){
				light_mode = 3;
				counter = yellow_counter;
			}
			break;
		case 3:
			HAL_GPIO_WritePin(PA1_GPIO_Port, PA1_Pin, SET);
			HAL_GPIO_WritePin(PA2_GPIO_Port, PA2_Pin, RESET);
			HAL_GPIO_WritePin(PA3_GPIO_Port, PA3_Pin, SET);

			HAL_GPIO_WritePin(PA4_GPIO_Port, PA4_Pin, RESET);
			HAL_GPIO_WritePin(PA5_GPIO_Port, PA5_Pin, SET);
			HAL_GPIO_WritePin(PA6_GPIO_Port, PA6_Pin, SET);
			if(counter <= 0){
				light_mode = 0;
				counter = red_counter;
			}
			break;
	}
}
